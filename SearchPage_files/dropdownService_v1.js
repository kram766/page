var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},DropDownFormatter=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"isEmpty",value:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},{key:"formatData",value:function(b,c,d,e){e=e?" "+e.trim():"";var f=c||"";try{if(b.constructor!==Object)throw"wrong data format";for(var g in b){if(null===b[g])return{data:null};var h=g,i=b[h],j={};for(var k in i){var l=l||{},m=k.replace("a",f);a.isEmpty(l)&&(j[m]={});var n,o,p=i[k],q={},r="",s="",t="",u=0;for(var v in p){if("object"!==_typeof(p[v])){if(i[k].labelType&&"s"===i[k].labelType.toLowerCase())if(d){var w=k.slice(1);l[w]||(l[w]={}),l[w][i[k].label]={},n=i[k].label,o=w}else l[i[k].label]={},n=i[k].label;else n?d?l[o][n][f+i[k].value]=i[k].label+e:l[n]["#"+i[k].value]=i[k].label+e:j[m]=p.label+e;break}"s"===p[v].labelType.toLowerCase()?(q[p[v].label]={},r=p[v].label,v.indexOf("-")>0&&(s=v,t=p[v].label)):r?(s&&(q[r][a.labelPrefix+s.slice(1,s.indexOf("-"))+u]=t,s="",t="",u++),q[r][f+p[v].value]=p[v].label):q[f+p[v].value]=p[v].label}a.isEmpty(q)?j=a.isEmpty(l)?j:l:j[m]=q}var x=h.replace(/\-/,"&").split("&");try{if(!x[1]){var y="";throw"version is missing"}y=x[1].split("-")[1]}catch(a){return a}return{data:j,version:y}}}catch(a){return a}}},{key:"formatLocation",value:function(a){var b=_extends({},a);return b.a185&&b.a185.Other&&(delete b.a185.Other.dd0,delete b.a185.Other.dd5000,delete b.a185.Other.dd5001,delete b.a185.Other.dd5002,delete b.a185.Other.dd5003,delete b.a185.Other.dd5004,delete b.a185.Other["dd68','69','70','71','72','73','74','75','76','77','78','79','80','81','93','82','145','83','84','85','86','87','88','89','5005"]),_extends({},{dd0:"Any",dd5000:"Anywhere in India",dd5001:"Anywhere in Northern India",dd5002:"Anywhere in South India",dd5003:"Anywhere in West India",dd5004:"Anywhere in East India","dd68','69','70','71','72','73','74','75','76','77','78','79','80','81','93','82','145','83','84','85','86','87','88','89','5005":"Any International Location"},b)}},{key:"formatFArea",value:function(a,b){function c(a){return a?Object.keys(a).reduce(function(b,c){return"[object Object]"===Object.prototype.toString.call(a[c])?b=_extends(b,a[c]):b[c]=a[c],b},{}):""}return b&&a?Object.keys(b).reduce(function(d,e){return d[e+"|X|"+b[e]]=c(a[e]),d},{}):null}},{key:"formatCourseData",value:function(a,b){function c(a,b){return a?Object.keys(a).reduce(function(c,d){return c[b+"."+d]=a[d],c},{}):""}return a&&b?Object.keys(a).reduce(function(d,e){return d[e+"|X|"+a[e]]=c(b[e],e),d},{}):null}}]),a}();DropDownFormatter.labelPrefix="Label_";var DropDownService=function(){function a(){classCallCheck(this,a),this.versions={},this.isDdDataRequested={},this.shouldCallVersionAPI=!1,this.queues={},this.queuesItemId=0}return createClass(a,[{key:"_makeAjaxCall",value:function(a){return new Promise(function(b,c){$.ajax({url:a,xhrFields:{withCredentials:!1},method:"GET",success:function(a){b(a)},error:function(a){c({})}})})}},{key:"_publish",value:function(a,b){var c=this;if(!this.queues[a])return!1;var d=this.queues[a];return setTimeout(function(){d.forEach(function(c){try{c.callback(b,a,c.id)}catch(a){}}),c.queues[a]=[]},0),!0}},{key:"_subscribe",value:function(a,b){this.queues[a]||(this.queues[a]=[]);var c=(this.queuesItemId++).toString();return this.queues[a].push({id:c,callback:b}),c}},{key:"unsubscribe",value:function(a,b){return!(!this.queues[b]||!this.queues[b].length)&&(this.queues[b]=this.queues[b].filter(function(b){return b.id!==a}),!0)}},{key:"_fetchDropDownData",value:function(a,b,c,d,e){var f=this,g="https://apis.naukri.com/central_services/dropdowns/v0/"+a+"/list?appid=2&languageId=1&prefix=a&formatType=nested&srcAppId=112";if(this._subscribe(a,e),!this.isDdDataRequested[a]){var h=this._makeAjaxCall(g);this.isDdDataRequested[a]=!0,h.then(function(e){var g=DropDownFormatter.formatData(e,b,c);d&&(g.data=DropDownFormatter.formatLocation(g.data)),f.isDdDataRequested[a]=!1,f._cacheData(a,g),f._publish(a,g)}).catch(function(){f.isDdDataRequested[a]=!1,f._publish(a,{data:null})})}}},{key:"getDropdownData",value:function(a,b,c,d,e){var f=this._getCachedData(a);if(f&&f.data)return this._isVersionSame(f.version,a)?void c(f):this._fetchDropDownData(a,b,d,e,c);this._fetchDropDownData(a,b,d,e,c)}},{key:"getDDVersions",value:function(a){var b=this._getCachedData("DDversions");if(b)return this.versions=b,void a(b);this._fetchDDVersions(a)}},{key:"_fetchDDVersions",value:function(a){var b=this;if(this._subscribe("versionQueue",a),!this.shouldCallVersionAPI){var c=this._makeAjaxCall("https://apis.naukri.com/central_services/dropdowns/v0/version?srcAppId=112");this.shouldCallVersionAPI=!0,c.then(function(a){var c=b._getMidnightDate();b._cacheData("DDversions",a,c),b.versions=a,b.shouldCallVersionAPI=!1,b._publish("versionQueue",a)}).catch(function(a){b.shouldCallVersionAPI=!1,b._publish("versionQueue",{})})}}},{key:"formatFArea",value:function(a,b){return DropDownFormatter.formatFArea(a,b)}},{key:"formatCourseData",value:function(a,b){return DropDownFormatter.formatCourseData(a,b)}},{key:"_isVersionSame",value:function(a,b){return this.versions[b]===a}},{key:"_getCachedData",value:function(a){return rdxCache.getItem(a+userId)}},{key:"_cacheData",value:function(a,b,c){rdxCache.setItem(a+window.userId,b,c?{expirationAbsolute:c}:null)}},{key:"_getMidnightDate",value:function(){var a=new Date;a.setDate(a.getDate()+1);var b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return new Date(c+"/"+b+"/"+d)}},{key:"getAllDDData",value:function(){var a=this;return[new Promise(function(b){a.getDropdownData("LOCATION","dd",function(a){b(a.data)},!0,!0)}),new Promise(function(b){a.getDropdownData("INDUSTRY_TYPE","dd",function(a){b(a.data)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("FA_ROLE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("FAREA","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatFArea(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("PPGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("PPGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("PGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("PGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("UGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("UGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})})]}}]),a}();window.dropDownService=new DropDownService;